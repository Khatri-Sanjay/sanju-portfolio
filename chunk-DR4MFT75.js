import{b as r}from"./chunk-7LIHKRHH.js";import{a as n}from"./chunk-IMBO46JX.js";import{Ha as a,Hc as i,da as l}from"./chunk-HFT7XNML.js";import{i as o}from"./chunk-66YHNWRR.js";var u=class h{chatVisible=a(!1);minimized=a(!1);maximized=a(!1);messages=a(this.getStoredMessages());typing=a(!1);chatVisible$=i(()=>this.chatVisible());minimized$=i(()=>this.minimized());maximized$=i(()=>this.maximized());messages$=i(()=>this.messages());typing$=i(()=>this.typing());API_URL=n.openRouter.URL;API_KEY=n.openRouter.KEY;API_MODEL=n.openRouter.MODEL;constructor(){this.messages().length===0&&this.sendBotInitialMessage()}toggleChat(){this.chatVisible.set(!this.chatVisible()),this.chatVisible()||(this.minimized.set(!1),this.maximized.set(!1))}toggleMinimize(){this.minimized.set(!this.minimized())}toggleMaximized(){this.maximized.set(!this.maximized())}sendMessage(e,s="text"){return o(this,null,function*(){if(!e.trim())return;let t={text:e,isBot:!1,timestamp:new Date,messageType:s,sender:"user"};this.messages.update(g=>[...g,t]),this.saveMessages(),yield this.simulateBotResponse(e)})}simulateBotResponse(e){return o(this,null,function*(){this.typing.set(!0),this.messages.update(t=>[...t,{text:"",isBot:!0,timestamp:new Date,isTyping:!0,sender:"bot"}]);let s=null;for(;!s;)s=yield this.getBotResponse(e),s||(yield new Promise(t=>setTimeout(t,1500)));this.messages.update(t=>t.slice(0,-1)),this.messages.update(t=>[...t,{text:s,isBot:!0,timestamp:new Date,sender:"bot",messageType:"text"}]),this.typing.set(!1),this.saveMessages()})}getBotResponse(e){return o(this,null,function*(){let s=e.toLowerCase().trim(),t={hello:"\u{1F44B} Hi! How can I help you today?",hi:"\u{1F44B} Hi! How can I help you today?",help:`<p>Here are some commands you can use:
                    <br>- help: Show this help message
                    <br>- info: Get app info
                    <br>- clear: Clear chat history
                    <br>- joke: Receive a joke
                    <br>- quote: Receive a random quote
                    <br>- info: Information
                </p>`,info:"This is a Portfolio Chat App v1.0 belongs to Sanju.",about:"This is a Portfolio Chat App v1.0 belongs to Sanju.","who are you":"I am Sanjay Khatri, your friendly chatbot. How can I assist you today?","how are you":"I\u2019m doing great, thanks for asking! How about you?",clear:()=>(this.clearChat(),"Chat history cleared!"),joke:()=>this.getRandomJoke(),quote:()=>this.getRandomQuote()};return t[s]?typeof t[s]=="function"?t[s]():t[s]:s.startsWith("quote ")?this.getQuoteByCategory(s.split(" ")[1]):yield this.openRouterMessage(e)})}getRandomJoke(){let e=["Why don't skeletons fight each other? They don't have the guts.","I told my wife she was drawing her eyebrows too high. She looked surprised.","Why don't oysters donate to charity? Because they are shellfish.","I used to play piano by ear, but now I use my hands.","Why don\u2019t programmers like nature? It has too many bugs."];return e[Math.floor(Math.random()*e.length)]}getRandomQuote(){let e=["The only limit to our realization of tomorrow is our doubts of today. - Franklin D. Roosevelt","The purpose of our lives is to be happy. - Dalai Lama","In the end, it's not the years in your life that count. It's the life in your years. - Abraham Lincoln"];return e[Math.floor(Math.random()*e.length)]}getQuoteByCategory(e){return{inspiration:"The only way to do great work is to love what you do. - Steve Jobs",life:"Life is what happens when you're busy making other plans. - John Lennon",success:"Success is not final, failure is not fatal: It is the courage to continue that counts. - Winston Churchill",love:"Love is not what you say, love is what you do. - Unknown"}[e.toLowerCase()]||"Category not found! Please try: inspiration, life, success, or love."}sendBotInitialMessage(){this.messages.update(e=>[...e,{text:"\u{1F44B} Hi! How can I help you today?",isBot:!0,timestamp:new Date,sender:"bot",messageType:"text"}]),this.saveMessages()}saveMessages(){let e=r.getStorage();e.chatMessages=JSON.stringify(this.messages()),r.setStorage(e)}getStoredMessages(){let e=r.getStorage().chatMessages;return e?JSON.parse(e):[]}clearChat(){this.messages.set([]),r.removeKey("chatMessages")}deleteMessage(e){this.messages.update(s=>{let t=[...s];return t[e].isDeleted=!0,t}),this.saveMessages()}fetchAIResponse(e,s){return o(this,null,function*(){try{let t=yield fetch(e,{method:"POST",headers:{Authorization:`Bearer ${this.API_KEY}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok){let g=yield t.text();throw new Error(`API request failed: ${t.statusText}, Response Body: ${g}`)}return yield t.json()}catch(t){throw console.error("Error fetching AI response:",t),new Error("An error occurred while fetching AI response.")}})}openRouterMessage(e){return o(this,null,function*(){let s={model:this.API_MODEL,messages:[{role:"user",content:e}]};try{let t=yield this.fetchAIResponse(this.API_URL,s);return console.log("Data from openRouterMessage:",t),t.choices?.[0]?.message?.content||"No response from AI."}catch{return"An error occurred while fetching AI response."}})}huggingChatMessage(e){return o(this,null,function*(){let s={inputs:e,parameters:{max_new_tokens:30}};try{let t=yield this.fetchAIResponse(`${this.API_URL}/${this.API_MODEL}`,s);return console.log("HuggingChat Response:",t),t[0]?.generated_text||"No response from AI."}catch(t){return`An error occurred: ${t}`}})}static \u0275fac=function(s){return new(s||h)};static \u0275prov=l({token:h,factory:h.\u0275fac,providedIn:"root"})};export{u as a};
