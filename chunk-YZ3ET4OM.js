import{a as Y}from"./chunk-ZT5HBNXB.js";import{a as X}from"./chunk-O5ENRYL2.js";import{Q as Z}from"./chunk-V3Y375FU.js";import{a as Q}from"./chunk-SEKNAWKX.js";import{b as A}from"./chunk-7EQR6UEB.js";import{c as L,e as w,f as O,g as R,h as U,j as W,l as $,o as H,u as z,w as K}from"./chunk-JA56CGLG.js";import"./chunk-JAKLN4DN.js";import"./chunk-YCIOEVS4.js";import{a as J}from"./chunk-5QEUZ45W.js";import"./chunk-INXHUJVL.js";import{j as M,n as q}from"./chunk-VSJQGL6V.js";import{$a as V,Ab as u,Fb as y,Gb as G,Hb as B,Ib as E,Jb as o,Kb as n,Lb as s,Pb as T,Tb as F,Ub as v,_a as D,ba as k,cc as m,dc as p,eb as r,ec as f,ha as d,nc as b,oc as N,pa as S,pb as j,pc as P,qa as I,ub as h}from"./chunk-QZTINFOT.js";import{a as x,b as _}from"./chunk-66YHNWRR.js";var C=class i{constructor(){}generateRandomNumericIdWithTimestamp(t){let l=this.shuffleCharacters("0123456789",5),c=new Date().getTime().toString().slice(-5),g=l+c,te=this.shuffleCharacters(g);return t+te}shuffleCharacters(t,e){let a="",l=J.isEmpty(e)?t.length:e;for(let c=l-1;c>=0;c--){let g=Math.floor(Math.random()*(c+1));a+=t.charAt(g),t=t.substring(0,g)+t.substring(g+1)}return a}static \u0275fac=function(e){return new(e||i)};static \u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})};var ne=(i,t)=>t.commentId;function oe(i,t){if(i&1&&s(0,"img",10),i&2){let e=v(2);u("src",e.post.imageUrl,V)("alt",e.post.title)}}function re(i,t){if(i&1&&(o(0,"span",17),m(1),n()),i&2){let e=t.$implicit;r(),p(e)}}function ae(i,t){i&1&&(o(0,"div",31),m(1," Comment is required. "),n())}function me(i,t){i&1&&(o(0,"div",31),m(1," Author Name is required. "),n())}function le(i,t){if(i&1){let e=T();o(0,"div",30)(1,"div",22)(2,"div",32),s(3,"img",33),o(4,"div")(5,"h6",8),m(6),n(),o(7,"small",9),m(8),b(9,"convertToStandardDateTime"),b(10,"date"),n()()(),o(11,"p",34),m(12),n(),o(13,"button",35),F("click",function(){let l=S(e).$implicit,c=v(2);return I(c.increaseLikes(l.commentId))}),s(14,"i",36),m(15),n()()()}if(i&2){let e=t.$implicit;r(6),p(e==null||e.author==null?null:e.author.name),r(2),f(" ",P(10,6,N(9,4,e.date),"medium")," "),r(4),p(e.content),r(3),f(" ",(e==null?null:e.likes)||0," ")}}function se(i,t){if(i&1){let e=T();o(0,"div",0)(1,"article",1)(2,"header",2)(3,"h1",3),m(4),n(),o(5,"div",4)(6,"div",5),s(7,"img",6),n(),o(8,"div",7)(9,"h6",8),m(10),n(),o(11,"small",9),m(12),b(13,"convertToStandardDateTime"),b(14,"date"),n()()(),h(15,oe,1,2,"img",10),n(),o(16,"div",11)(17,"div",12)(18,"div",13)(19,"p",14),m(20),n()(),o(21,"div",13),s(22,"p",15),n(),o(23,"div",16),B(24,re,2,1,"span",17,G),n(),s(26,"hr",18),o(27,"section",19)(28,"h3",20),m(29),n(),o(30,"div",21)(31,"div",22)(32,"h5",23),m(33,"Leave a Comment"),n(),o(34,"form",24)(35,"div",25)(36,"textarea",26),m(37,"                      "),n(),h(38,ae,2,0,"div",27),n(),o(39,"div",25),s(40,"input",28),h(41,me,2,0,"div",27),n(),o(42,"button",29),F("click",function(){S(e);let l=v();return I(l.addComment())}),m(43,"Post Comment"),n()()()(),B(44,le,16,9,"div",30,ne),n()()()()()}if(i&2){let e=v();r(4),p(e.post.title),r(6),p("Sanjay Khatri"),r(2),f(" ",P(14,12,N(13,10,e.post.updatedAt),"medium")," "),r(3),y(e.post.imageUrl?15:-1),r(5),p(e.post.description),r(2),u("innerHTML",e.post.detailDescription,D),r(2),E(e.post.tags),r(5),f("Comments (",e.post.comments==null?null:e.post.comments.length,")"),r(5),u("formGroup",e.blogForm),r(4),u("ngIf",e.isInvalid("comment")),r(3),u("ngIf",e.isInvalid("authorName")),r(3),E(e.post.comments)}}var ee=class i{blogForm=new U({});post;blogId;route=d(A);blogService=d(X);formBuilder=d(z);uniqueValueGenerator=d(C);toastrService=d(Q);spinnerService=d(Z);ngOnInit(){this.route.params.subscribe(t=>{this.blogId=t.postId,this.blogService.getBlogById(this.blogId).subscribe(e=>{this.post=e,console.log("this.post",this.post)})}),this.blogForm=this.formBuilder.group({comment:["",w.required],authorName:["",w.required]})}addComment(){if(this.blogForm.invalid)return;let t=this.blogForm.value.comment,e=this.blogForm.value.authorName;console.log("commentContent",t);let a={commentId:this.uniqueValueGenerator.generateRandomNumericIdWithTimestamp("C"),content:t,author:{authorId:this.uniqueValueGenerator.generateRandomNumericIdWithTimestamp("A"),name:e,avatar:"",bio:""},date:new Date,likes:0},l=x({},this.post);a&&l&&l.comments&&l?.comments?.push(a),this.saveBlogData(l)}saveBlogData(t,e){console.log("vsdsd",t),this.blogService.updateBlog(this.blogId,t).subscribe({next:()=>{e||(this.blogForm.reset(),this.toastrService.success("Comment added successfully"))},error:a=>this.handleError(a,"Failed to update user."),complete:()=>this.spinnerService.hide()})}handleError(t,e){console.error(t),this.toastrService.error(e),this.spinnerService.hide()}isInvalid(t){let e=this.blogForm.get(t);return!!(e?.invalid&&e?.touched)}increaseLikes(t){if(!this.post||!this.post.comments)return;let e=this.post.comments.map(a=>a.commentId===t?_(x({},a),{likes:a.likes+1}):a);this.post=_(x({},this.post),{comments:e}),this.saveBlogData(this.post,!0)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=j({type:i,selectors:[["app-blog-post"]],decls:1,vars:1,consts:[[1,"container","py-5"],[1,"mb-5"],[1,"text-center","mb-4"],[1,"display-4","mb-3"],[1,"d-flex","justify-content-center","align-items-center","mb-4"],[1,"avatar","mx-3"],["src","assets/image/sanjuprofile.png","alt","sanju"],[1,"text-start"],[1,"mb-0"],[1,"text-muted"],[1,"img-fluid","rounded","shadow-lg","mb-4",3,"src","alt"],[1,"row","justify-content-center"],[1,"col-lg-8"],[1,"content"],[1,"lead"],[1,"lead",3,"innerHTML"],[1,"tags","mt-4"],[1,"badge","bg-primary","me-2"],[1,"my-5"],[1,"comments"],[1,"mb-4"],[1,"card","mb-4"],[1,"card-body"],[1,"card-title"],[3,"formGroup"],[1,"mb-3"],["rows","3","formControlName","comment","placeholder","Write your comment...",1,"form-control"],["class","error-text",4,"ngIf"],["formControlName","authorName","placeholder","Author Name...",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"card","mb-3"],[1,"error-text"],[1,"d-flex","mb-3"],["src","https://picsum.photos/seed/css/800/400","width","40","height","40",1,"rounded-circle","me-2"],[1,"card-text"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-hand-thumbs-up"]],template:function(e,a){e&1&&h(0,se,46,15,"div",0),e&2&&y(a.post?0:-1)},dependencies:[q,Y,K,W,L,O,R,$,H,M],styles:[".avatar[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,#0984e3,#00b894);display:flex;align-items:center;justify-content:center;overflow:hidden;border:3px solid green;position:relative}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:center}"]})};export{ee as BlogPostComponent};
