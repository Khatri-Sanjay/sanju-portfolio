import{a as at}from"./chunk-SKEE7AUV.js";import{a as rt}from"./chunk-4R67E2WU.js";import{b as R}from"./chunk-IF3YDNZ5.js";import{a as it}from"./chunk-5QEUZ45W.js";import{a as ot}from"./chunk-OVMOFTWO.js";import{a as nt}from"./chunk-MEU4ASEB.js";import{c as X,d as Z,f as d,g as V,h as tt,i as et}from"./chunk-INCNJZSV.js";import{c as U,e as D,f as H,g as W,h as $,j as z,l as Q,o as Y,v as K,x as J}from"./chunk-6I25OQ6Z.js";import"./chunk-INXHUJVL.js";import"./chunk-H4BR2RBL.js";import{j as L,n as O}from"./chunk-7YC4NHZP.js";import{Bb as k,Eb as B,Fb as q,Gb as E,Hb as T,Ib as o,Jb as n,Kb as c,Ob as P,Sb as w,Tb as v,Za as M,_a as G,aa as j,bc as l,cc as h,db as r,dc as C,ga as u,mc as _,nc as F,oa as y,ob as A,oc as N,pa as I,tb as x,zb as f}from"./chunk-V2OWRJG2.js";import{a as g,b}from"./chunk-66YHNWRR.js";var S=class i{constructor(){}generateRandomNumericIdWithTimestamp(e){let s=this.shuffleCharacters("0123456789",5),m=new Date().getTime().toString().slice(-5),p=s+m,mt=this.shuffleCharacters(p);return e+mt}shuffleCharacters(e,t){let a="",s=it.isEmpty(t)?e.length:t;for(let m=s-1;m>=0;m--){let p=Math.floor(Math.random()*(m+1));a+=e.charAt(p),e=e.substring(0,p)+e.substring(p+1)}return a}static \u0275fac=function(t){return new(t||i)};static \u0275prov=j({token:i,factory:i.\u0275fac,providedIn:"root"})};var ct=(i,e)=>e.commentId;function dt(i,e){if(i&1&&c(0,"img",10),i&2){let t=v(2);f("src",t.post.imageUrl,G)("alt",t.post.title)}}function pt(i,e){if(i&1&&(o(0,"span",17),l(1),n()),i&2){let t=e.$implicit;r(),h(t)}}function ut(i,e){i&1&&(o(0,"div",31),l(1," * Comment is required. "),n())}function ft(i,e){i&1&&(o(0,"div",31),l(1," * Author Name is required. "),n())}function ht(i,e){if(i&1){let t=P();o(0,"div",30)(1,"div",22)(2,"div",32),c(3,"img",33),o(4,"div")(5,"h6",8),l(6),n(),o(7,"small",9),l(8),_(9,"convertToStandardDateTime"),_(10,"date"),n()()(),o(11,"p",34),l(12),n(),o(13,"button",35),w("click",function(s){let m=y(t).$implicit,p=v(2);return I(p.increaseLikes(m.commentId,s))}),c(14,"i",36),l(15),n()()()}if(i&2){let t=e.$implicit,a=v(2);r(6),h(t==null||t.author==null?null:t.author.name),r(2),C(" ",N(10,15,F(9,13,t.date),"medium")," "),r(4),h(t.content),r(),k("btn-primary",a.likedComments[t.commentId])("btn-outline-primary",!a.likedComments[t.commentId]),r(),k("bi-hand-thumbs-up-fill",a.likedComments[t.commentId])("bi-hand-thumbs-up",!a.likedComments[t.commentId]),f("@likeAnimation",a.animationStates[t.commentId]||"inactive"),r(),C(" ",(t==null?null:t.likes)||0," ")}}function gt(i,e){if(i&1){let t=P();o(0,"div",0)(1,"article",1)(2,"header",2)(3,"h1",3),l(4),n(),o(5,"div",4)(6,"div",5),c(7,"img",6),n(),o(8,"div",7)(9,"h6",8),l(10),n(),o(11,"small",9),l(12),_(13,"convertToStandardDateTime"),_(14,"date"),n()()(),x(15,dt,1,2,"img",10),n(),o(16,"div",11)(17,"div",12)(18,"div",13)(19,"p",14),l(20),n()(),o(21,"div",13),c(22,"p",15),n(),o(23,"div",16),E(24,pt,2,1,"span",17,q),n(),c(26,"hr",18),o(27,"section",19)(28,"h3",20),l(29),n(),o(30,"div",21)(31,"div",22)(32,"h5",23),l(33,"Leave a Comment"),n(),o(34,"form",24)(35,"div",25)(36,"textarea",26),l(37,"                      "),n(),x(38,ut,2,0,"div",27),n(),o(39,"div",25),c(40,"input",28),x(41,ft,2,0,"div",27),n(),o(42,"button",29),w("click",function(){y(t);let s=v();return I(s.addComment())}),l(43,"Post Comment"),n()()()(),E(44,ht,16,18,"div",30,ct),n()()()()()}if(i&2){let t=v();r(4),h(t.post.title),r(6),h("Sanjay Khatri"),r(2),C(" ",N(14,12,F(13,10,t.post.updatedAt),"medium")," "),r(3),B(t.post.imageUrl?15:-1),r(5),h(t.post.description),r(2),f("innerHTML",t.post.detailDescription,M),r(2),T(t.post.tags),r(5),C("Comments (",t.post.comments==null?null:t.post.comments.length,")"),r(5),f("formGroup",t.blogForm),r(4),f("ngIf",t.isInvalid("comment")),r(3),f("ngIf",t.isInvalid("authorName")),r(3),T(t.post.comments)}}var st=class i{blogForm=new $({});post;blogId;animationStates={};likedComments={};route=u(R);blogService=u(rt);formBuilder=u(K);uniqueValueGenerator=u(S);toastrService=u(nt);spinnerService=u(ot);ngOnInit(){this.route.params.subscribe(e=>{this.blogId=e.postId,this.blogService.getBlogById(this.blogId).subscribe(t=>{this.post=t,console.log("this.post",this.post)})}),this.post&&this.post.comments&&this.post.comments.forEach(e=>{this.animationStates[e.commentId]="inactive",this.likedComments[e.commentId]=!1}),this.blogForm=this.formBuilder.group({comment:["",D.required],authorName:["",D.required]})}addComment(){if(this.blogForm.invalid)return;let e=this.blogForm.value.comment,t=this.blogForm.value.authorName;console.log("commentContent",e);let a={commentId:this.uniqueValueGenerator.generateRandomNumericIdWithTimestamp("C"),content:e,author:{authorId:this.uniqueValueGenerator.generateRandomNumericIdWithTimestamp("A"),name:t,avatar:"",bio:""},date:new Date,likes:0},s=g({},this.post);a&&s&&s.comments&&s?.comments?.push(a),this.saveBlogData(s)}saveBlogData(e,t){console.log("vsdsd",e),this.blogService.updateBlog(this.blogId,e).subscribe({next:()=>{t||(this.blogForm.reset(),this.toastrService.success("Comment added successfully"))},error:a=>this.handleError(a,"Failed to update user."),complete:()=>this.spinnerService.hide()})}handleError(e,t){console.error(e),this.toastrService.error(t),this.spinnerService.hide()}isInvalid(e){let t=this.blogForm.get(e);return!!(t?.invalid&&t?.touched)}increaseLikes(e,t){if(t.stopPropagation(),!(!this.post||!this.post.comments||!this.post.comments.find(s=>s.commentId===e))){if(this.likedComments[e]){let s=this.post.comments.map(m=>m.commentId===e?b(g({},m),{likes:Math.max(0,m.likes-1)}):m);this.post=b(g({},this.post),{comments:s}),this.likedComments[e]=!1}else if(this.animationStates[e]!=="active"){this.animationStates[e]="active";let s=this.post.comments.map(m=>m.commentId===e?b(g({},m),{likes:m.likes+1}):m);this.post=b(g({},this.post),{comments:s}),this.likedComments[e]=!0,setTimeout(()=>{this.animationStates[e]="inactive"},500)}this.saveBlogData(this.post,!0)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["app-blog-post"]],decls:1,vars:1,consts:[[1,"container","py-5"],[1,"mb-5"],[1,"text-center","mb-4"],[1,"display-4","mb-3"],[1,"d-flex","justify-content-center","align-items-center","mb-4"],[1,"avatar","mx-3"],["src","assets/image/sanjuprofile.png","alt","sanju"],[1,"text-start"],[1,"mb-0"],[1,"text-muted"],[1,"img-fluid","rounded","shadow-lg","mb-4",3,"src","alt"],[1,"row","justify-content-center"],[1,"col-lg-12"],[1,"content"],[1,"lead","text-justify","fs-5","fs-sm-6","fs-md-7","fs-lg-8"],[1,"lead","text-wrap","text-break","fs-5","fs-sm-6","fs-md-7","fs-lg-8","px-3",3,"innerHTML"],[1,"tags","mt-4"],[1,"badge","bg-primary","me-2"],[1,"my-5"],[1,"comments"],[1,"mb-4"],[1,"card","mb-4"],[1,"card-body"],[1,"card-title"],[3,"formGroup"],[1,"mb-3"],["rows","4","formControlName","comment","placeholder","Write your comment...",1,"form-control"],["class","text-danger text-sm-start",4,"ngIf"],["formControlName","authorName","placeholder","Author Name...",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"card","mb-3"],[1,"text-danger","text-sm-start"],[1,"d-flex","mb-3"],["src","https://picsum.photos/seed/css/800/400","width","40","height","40",1,"rounded-circle","me-2"],[1,"card-text"],[1,"btn","btn-sm",3,"click"],[1,"bi"]],template:function(t,a){t&1&&x(0,gt,46,15,"div",0),t&2&&B(a.post?0:-1)},dependencies:[O,at,J,z,U,H,W,Q,Y,L],styles:[".avatar[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,#0984e3,#00b894);display:flex;align-items:center;justify-content:center;overflow:hidden;border:3px solid green;position:relative}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:center}.text-justify[_ngcontent-%COMP%]{text-align:justify!important}"],data:{animation:[X("likeAnimation",[V("inactive",d({transform:"scale(1)",color:"inherit"})),V("active",d({transform:"scale(1)",color:"inherit"})),et("inactive => active",[Z("500ms ease-out",tt([d({transform:"scale(1)",offset:0}),d({transform:"scale(1.5)",color:"#ff2b56",offset:.3}),d({transform:"scale(1.5) translateY(-10px)",color:"#ff2b56",offset:.5}),d({transform:"scale(1.2) translateY(-5px)",color:"#ff2b56",offset:.7}),d({transform:"scale(1)",offset:1})]))])])]}})};export{st as BlogPostComponent};
