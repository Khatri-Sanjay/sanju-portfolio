import{A as F,C as b,D as A,E as p,F as T,G as d,I as N,J as E,K as h,L as P,M as S,N as L,O as R,z as C}from"./chunk-BCJ4UAAH.js";import{a as B}from"./chunk-Z3CAS5DY.js";import{a as v}from"./chunk-4HP7DDNK.js";import{a as $}from"./chunk-LGDAR4N5.js";import{G as c,aa as O,f as y,fa as I,ga as u,n as g,p as s,t as l,tb as w}from"./chunk-M5KNFO6E.js";import{a as m,b as f}from"./chunk-66YHNWRR.js";var D=class i{constructor(e){this.firestore=e}static API=v.baseApiUrl;getApi(){return i.API}http=u($);toastrService=u(B);errorSubject=new y;COLLECTION_NAME="blogs";createBlog(e){try{let r=p(this.firestore,this.COLLECTION_NAME),t=d(r),o=f(m({},e),{createdAt:new Date,updatedAt:new Date,comments:[]});return g(P(t,o)).pipe(l(()=>t.id),c(a=>(console.error("Error creating blog:",a),s(()=>new Error(`Failed to create blog: ${a.message}`)))))}catch(r){return s(()=>new Error(`Failed to create blog: ${r.message}`))}}getAllBlogs(e=1,r=10){try{let t=p(this.firestore,this.COLLECTION_NAME),o=[E("createdAt","desc"),N(r)];e>1&&o.push(S((e-1)*r));let a=h(t,...o);return b(a,{idField:"postId"}).pipe(l(n=>n),c(n=>(console.error("Error fetching blogs:",n),s(()=>new Error(`Failed to fetch blogs: ${n.message}`)))))}catch(t){return s(()=>new Error(`Failed to fetch blogs: ${t.message}`))}}getBlogById(e){try{let r=d(this.firestore,`${this.COLLECTION_NAME}/${e}`);return A(r,{idField:"postId"}).pipe(l(t=>t),c(t=>(console.error("Error fetching blog:",t),s(()=>new Error(`Failed to fetch blog: ${t.message}`)))))}catch(r){return s(()=>new Error(`Failed to fetch blog: ${r.message}`))}}updateBlog(e,r){try{let t=d(this.firestore,`${this.COLLECTION_NAME}/${e}`),o=f(m({},r),{updatedAt:new Date});return g(L(t,o)).pipe(c(a=>(console.error("Error updating blog:",a),s(()=>new Error(`Failed to update blog: ${a.message}`)))))}catch(t){return s(()=>new Error(`Failed to update blog: ${t.message}`))}}deleteBlog(e){try{let r=d(this.firestore,`${this.COLLECTION_NAME}/${e}`);return g(T(r)).pipe(c(t=>(console.error("Error deleting blog:",t),s(()=>new Error(`Failed to delete blog: ${t.message}`)))))}catch(r){return s(()=>new Error(`Failed to delete blog: ${r.message}`))}}searchBlogsByTag(e){try{let r=p(this.firestore,this.COLLECTION_NAME),t=h(r,R("tags","array-contains",e),E("createdAt","desc"));return b(t,{idField:"postId"}).pipe(l(o=>o),c(o=>(console.error("Error searching blogs:",o),s(()=>new Error(`Failed to search blogs: ${o.message}`)))))}catch(r){return s(()=>new Error(`Failed to search blogs: ${r.message}`))}}static \u0275fac=function(r){return new(r||i)(I(F))};static \u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"})};var H=class i{transform(e){try{if(e instanceof C)return e.toDate().toISOString();if(e instanceof Date&&!isNaN(e.getTime()))return e.toISOString();if(typeof e=="string"){let r=new Date(e);if(!isNaN(r.getTime()))return r.toISOString();let t=[/^\d{4}\/\d{1,2}\/\d{1,2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{4}-\d{1,2}-\d{1,2}$/,/^\d{4}\.\d{1,2}\.\d{1,2}$/,/^\d{1,2}-\d{1,2}-\d{4}$/];for(let o of t)if(o.test(e)){let n=e.replace(/[-\/\.]/g,"-").split("-").map(M=>parseInt(M,10));return o===t[4]?new Date(n[2],n[1]-1,n[0]).toISOString():new Date(n[0],n[1]-1,n[2]||1).toISOString()}}return null}catch(r){return console.error("Error converting date:",r),null}}static \u0275fac=function(r){return new(r||i)};static \u0275pipe=w({name:"convertToStandardDateTime",type:i,pure:!0})};export{D as a,H as b};
